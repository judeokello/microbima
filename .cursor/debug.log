{"location":"product-management.controller.ts:createPostpaidSchemePayment","message":"Postpaid payment create failed","data":{"schemeId":2,"transactionReference":"dfg34545","errorMessage":"\nInvalid `txClient.policy.update()` invocation in\n/home/judeokello/Projects/microbima/apps/api/src/services/policy.service.ts:1154:53\n\n  1151 }\n  1152 \n  1153 // Update policy with policy number, dates, and status\n→ 1154 const updatedPolicy = await txClient.policy.update(\nUnique constraint failed on the fields: (`policyNumber`)","errorCode":"P2002","prismaMeta":{"modelName":"Policy","target":["policyNumber"]}},"timestamp":1772123201034,"hypothesisId":"postpaid-create-error"}
{"location":"scheme-page:handleSubmitPayment","message":"Postpaid payment API error","data":{"status":422,"statusText":"Unprocessable Entity","errData":{"error":{"code":"RESOURCE_CONFLICT","status":422,"message":"A record with this policy number already exists","details":{"constraint":"A record with this policy number already exists"},"correlationId":"unknown","timestamp":"2026-02-26T16:26:41.036Z","path":"/api/internal/product-management/schemes/2/postpaid-payments","stack":"PrismaClientKnownRequestError: \nInvalid `txClient.policy.update()` invocation in\n/home/judeokello/Projects/microbima/apps/api/src/services/policy.service.ts:1154:53\n\n  1151 }\n  1152 \n  1153 // Update policy with policy number, dates, and status\n→ 1154 const updatedPolicy = await txClient.policy.update(\nUnique constraint failed on the fields: (`policyNumber`)\n    at ei.handleRequestError (/home/judeokello/Projects/microbima/node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.3.3/node_modules/@prisma/client/src/runtime/RequestHandler.ts:228:13)\n    at ei.handleAndLogRequestError (/home/judeokello/Projects/microbima/node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.3.3/node_modules/@prisma/client/src/runtime/RequestHandler.ts:174:12)\n    at ei.request (/home/judeokello/Projects/microbima/node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.3.3/node_modules/@prisma/client/src/runtime/RequestHandler.ts:143:12)\n    at async a (/home/judeokello/Projects/microbima/node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.3.3/node_modules/@prisma/client/src/runtime/getPrismaClient.ts:833:24)\n    at async executeActivation (/home/judeokello/Projects/microbima/apps/api/src/services/policy.service.ts:1154:31)\n    at async PolicyService.activatePolicy (/home/judeokello/Projects/microbima/apps/api/src/services/policy.service.ts:1249:16)\n    at async <anonymous> (/home/judeokello/Projects/microbima/apps/api/src/services/postpaid-scheme-payment.service.ts:320:11)\n    at async Proxy._transactionWithCallback (/home/judeokello/Projects/microbima/node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.3.3/node_modules/@prisma/client/src/runtime/getPrismaClient.ts:722:18)\n    at async PostpaidSchemePaymentService.create (/home/judeokello/Projects/microbima/apps/api/src/services/postpaid-scheme-payment.service.ts:245:21)\n    at async ProductManagementController.createPostpaidSchemePayment (/home/judeokello/Projects/microbima/apps/api/src/controllers/internal/product-management.controller.ts:1040:20)"}}},"timestamp":1772123201042,"hypothesisId":"postpaid-api-error"}
